var re=Object.defineProperty;var de=(n,e,t)=>e in n?re(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var x=(n,e,t)=>de(n,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function t(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=t(r);fetch(r.href,o)}})();class ae{generateId(){return Date.now().toString(36)+Math.random().toString(36).substring(2)}getItems(e){const t=localStorage.getItem(e);return t?JSON.parse(t):[]}saveItems(e,t){localStorage.setItem(e,JSON.stringify(t))}getForms(){return this.getItems("forms")}getFormById(e){return this.getForms().find(s=>s.id===e)||null}saveForm(e){const t=this.getForms(),s=Date.now();if(e.id){const o=t.findIndex(i=>i.id===e.id);if(o>=0){const i={...t[o],...e,updatedAt:s};return t[o]=i,this.saveItems("forms",t),i}}const r={...e,id:e.id||this.generateId(),createdAt:s,updatedAt:s};return t.push(r),this.saveItems("forms",t),r}deleteForm(e){const t=this.getForms(),s=t.filter(r=>r.id!==e);return s.length<t.length?(this.saveItems("forms",s),this.deleteFormSubmissions(e),!0):!1}getFormSubmissions(e){return this.getItems("submissions").filter(s=>s.formId===e)}saveFormSubmission(e,t){const s=this.getItems("submissions"),r={id:this.generateId(),formId:e,responses:t,submittedAt:Date.now()};return s.push(r),this.saveItems("submissions",s),r}deleteFormSubmissions(e){const s=this.getItems("submissions").filter(r=>r.formId!==e);this.saveItems("submissions",s)}}var d=(n=>(n.TEXT="text",n.RADIO="radio",n.CHECKBOX="checkbox",n.DROPDOWN="dropdown",n))(d||{});class le{validateFormSubmission(e,t){const s=[],r=t.reduce((o,i)=>(o[i.fieldId]=i,o),{});return e.fields.forEach(o=>{const i=r[o.id];if(o.required){if(!i){s.push(`Field "${o.label}" is required but no response was provided.`);return}o.type===d.TEXT&&(!i.value||i.value.trim()==="")?s.push(`Field "${o.label}" is required but was left empty.`):o.type===d.RADIO&&(!i.value||i.value.trim()==="")?s.push(`Field "${o.label}" is required but no option was selected.`):o.type===d.DROPDOWN&&(!i.value||i.value.trim()==="")?s.push(`Field "${o.label}" is required but no option was selected.`):o.type===d.CHECKBOX&&(!i.value||i.value.length===0)&&s.push(`Field "${o.label}" is required but no option was selected.`)}if(i){if(o.type===d.TEXT&&typeof i.value!="string"?s.push(`Field "${o.label}" requires a text response.`):o.type===d.RADIO&&typeof i.value!="string"?s.push(`Field "${o.label}" requires a single selected option.`):o.type===d.DROPDOWN&&typeof i.value!="string"?s.push(`Field "${o.label}" requires a single selected option.`):o.type===d.CHECKBOX&&!Array.isArray(i.value)&&s.push(`Field "${o.label}" requires checkbox selections.`),(o.type===d.RADIO||o.type===d.DROPDOWN)&&o.options)o.options.map(c=>c.id).includes(i.value)||s.push(`Field "${o.label}" contains an invalid selection.`);else if(o.type===d.CHECKBOX&&o.options){const l=o.options.map(c=>c.id);i.value.every(c=>l.includes(c))||s.push(`Field "${o.label}" contains invalid selections.`)}}}),s}}class ce{constructor(e){x(this,"storageService");this.storageService=e}getAllForms(){return this.storageService.getForms()}getForm(e){return this.storageService.getFormById(e)}createForm(e,t){return this.storageService.saveForm({title:e,description:t,fields:[]})}updateFormDetails(e,t,s){const r=this.getForm(e);return r?this.storageService.saveForm({...r,title:t,description:s}):null}addField(e,t,s,r=!1,o=[]){const i=this.getForm(e);if(!i)return null;const l={id:Date.now().toString(36)+Math.random().toString(36).substring(2),type:t,label:s,required:r,order:i.fields.length,...t!==d.TEXT?{options:o}:{}},c={...i,fields:[...i.fields,l]};return this.storageService.saveForm(c)}updateField(e,t,s){const r=this.getForm(e);if(!r)return null;const o=r.fields.findIndex(c=>c.id===t);if(o===-1)return null;const i=[...r.fields];i[o]={...i[o],...s};const l={...r,fields:i};return this.storageService.saveForm(l)}deleteField(e,t){const s=this.getForm(e);if(!s)return null;const r=s.fields.filter(i=>i.id!==t);r.forEach((i,l)=>{i.order=l});const o={...s,fields:r};return this.storageService.saveForm(o)}reorderFields(e,t){const s=this.getForm(e);if(!s||t.length!==s.fields.length||!t.every(l=>s.fields.some(c=>c.id===l)))return null;const r=s.fields.reduce((l,c)=>(l[c.id]=c,l),{}),o=t.map((l,c)=>({...r[l],order:c})),i={...s,fields:o};return this.storageService.saveForm(i)}deleteForm(e){return this.storageService.deleteForm(e)}submitFormResponses(e,t){return this.getForm(e)?this.storageService.saveFormSubmission(e,t):null}getFormSubmissions(e){return this.storageService.getFormSubmissions(e)}}const y=class y{static getInstance(){return y.instance||(y.instance=new y),y.instance}showNotification(e,t="info"){const s=document.createElement("div");s.className=`notification ${t}`,s.textContent=e,document.body.appendChild(s),setTimeout(()=>{s.style.opacity="0",setTimeout(()=>{s.remove()},300)},3e3)}};x(y,"instance");let N=y;const ue=new ae,v=new ce(ue),me=new le,F=new N,pe=window.matchMedia("(prefers-color-scheme: dark)"),J=localStorage.getItem("theme");let a=null,A=null,b=null,C=!1;J==="dark"||!J&&pe.matches?document.documentElement.setAttribute("data-theme","dark"):document.documentElement.setAttribute("data-theme","light");document.getElementById("mainContent");const P=document.getElementById("viewFormsBtn"),M=document.getElementById("createFormBtn"),_=document.getElementById("formsList"),z=document.getElementById("emptyFormsList"),E=document.getElementById("formsListView"),I=document.getElementById("formBuilderView"),Y=document.getElementById("formPreviewView"),Z=document.getElementById("formResponsesView"),B=document.getElementById("formTitle"),L=document.getElementById("formDescription"),ee=document.getElementById("formFields"),ve=document.getElementById("saveFormBtn"),fe=document.getElementById("previewFormBtn"),ge=document.querySelectorAll(".field-type-btn"),R=document.getElementById("fieldModal"),he=document.getElementById("modalTitle"),te=document.getElementById("fieldLabel"),se=document.getElementById("fieldRequired"),G=document.getElementById("optionsContainer"),H=document.getElementById("optionsList"),be=document.getElementById("addOptionBtn"),ye=document.getElementById("saveFieldBtn"),Fe=document.getElementById("cancelFieldBtn"),Ee=document.querySelector(".close-modal"),we=document.getElementById("previewFormTitle"),Ie=document.getElementById("previewFormDescription"),Be=document.getElementById("previewForm"),Le=document.getElementById("submitPreviewBtn"),Se=document.getElementById("backToEditBtn"),$e=document.getElementById("theme-toggle");P.addEventListener("click",()=>{g(E),S()});M.addEventListener("click",()=>{g(I),B.value="Untitled Form",L.value="",ee.innerHTML="",a=null,R.classList.add("hidden"),a=null,R.classList.add("hidden")});ge.forEach(n=>{n.addEventListener("click",()=>{a||(a=v.createForm(B.value||"Untitled Form",L.value));const e=n.getAttribute("data-type");e&&ne(e)})});ye.addEventListener("click",Te);Fe.addEventListener("click",U);Ee.addEventListener("click",U);be.addEventListener("click",j);$e.addEventListener("click",Oe);ve.addEventListener("click",()=>{a?a=v.updateFormDetails(a.id,B.value,L.value):a=v.createForm(B.value||"Untitled Form",L.value),F.showNotification("Form saved successfully!","success"),g(E),S(),a=null});fe.addEventListener("click",()=>{a&&(De(),g(Y))});Se.addEventListener("click",()=>{g(I)});Le.addEventListener("click",Ae);S();function Oe(){const e=document.documentElement.getAttribute("data-theme")==="light"?"dark":"light";document.documentElement.setAttribute("data-theme",e),localStorage.setItem("theme",e),ke()}function ke(){const n=document.documentElement.getAttribute("data-theme"),e=document.getElementById("theme-icon");e&&(n==="dark"?e.textContent="â˜€ï¸":e.textContent="ðŸŒ™")}function g(n){E.classList.add("hidden"),I.classList.add("hidden"),Y.classList.add("hidden"),Z.classList.add("hidden"),n.classList.remove("hidden"),P.classList.remove("active"),M.classList.remove("active"),n===E?P.classList.add("active"):n===I&&M.classList.add("active")}function S(){const n=v.getAllForms();n.length===0?(_.innerHTML="",z.style.display="block"):(z.style.display="none",_.innerHTML=n.map(e=>`
            <div class="form-card" data-id="${e.id}">
                <h3>${e.title||"Untitled Form"}</h3>
                <p>${e.description||"No description"}</p>
                <div class="form-card-actions">
                    <button class="card-btn edit-form-btn" data-id="${e.id}">Edit</button>
                    <button class="card-btn view-responses-btn" data-id="${e.id}">View Responses</button>
                    <button class="card-btn delete-form-btn" data-id="${e.id}">Delete</button>
                </div>
            </div>
        `).join(""),document.querySelectorAll(".edit-form-btn").forEach(e=>{e.addEventListener("click",t=>{t.stopPropagation();const s=e.getAttribute("data-id");s&&Q(s)})}),document.querySelectorAll(".view-responses-btn").forEach(e=>{e.addEventListener("click",t=>{t.stopPropagation();const s=e.getAttribute("data-id");s&&Re(s)})}),document.querySelectorAll(".delete-form-btn").forEach(e=>{e.addEventListener("click",t=>{t.stopPropagation();const s=e.getAttribute("data-id");s&&confirm("Are you sure you want to delete this form?")&&(v.deleteForm(s),S())})}),document.querySelectorAll(".form-card").forEach(e=>{e.addEventListener("click",()=>{const t=e.getAttribute("data-id");t&&Q(t)})}))}function Q(n){a=v.getForm(n),a&&(B.value=a.title,L.value=a.description,X(),g(I))}function X(){a&&(ee.innerHTML=[...a.fields].sort((n,e)=>n.order-e.order).map(n=>{let e="";switch(n.type){case d.TEXT:e='<input type="text" disabled placeholder="Text field" class="preview-input">';break;case d.RADIO:e=(n.options||[]).map(t=>`
                        <div class="option-preview">
                            <input type="radio" disabled>
                            <label>${t.value}</label>
                        </div>
                    `).join("");break;case d.CHECKBOX:e=(n.options||[]).map(t=>`
                        <div class="option-preview">
                            <input type="checkbox" disabled>
                            <label>${t.value}</label>
                        </div>
                    `).join("");break;case d.DROPDOWN:e=`
                        <select disabled class="preview-select">
                            <option value="">Select an option</option>
                            ${(n.options||[]).map(t=>`
                                <option value="${t.id}">${t.value}</option>
                            `).join("")}
                        </select>
                    `;break}return`
                <div class="form-field" data-id="${n.id}">
                    <div class="field-actions">
                        <button class="field-action edit-field-btn" data-id="${n.id}">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                        <button class="field-action delete-field-btn" data-id="${n.id}">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </div>
                    <div class="field-label">
                        ${n.label} ${n.required?'<span class="field-required">*</span>':""}
                    </div>
                    <div class="field-content">
                        ${e}
                    </div>
                </div>
            `}).join(""),document.querySelectorAll(".edit-field-btn").forEach(n=>{n.addEventListener("click",()=>{const e=n.getAttribute("data-id");if(e&&a){const t=a.fields.find(s=>s.id===e);t&&Ce(t)}})}),document.querySelectorAll(".delete-field-btn").forEach(n=>{n.addEventListener("click",()=>{const e=n.getAttribute("data-id");e&&a&&confirm("Are you sure you want to delete this field?")&&(a=v.deleteField(a.id,e),X())})}))}function ne(n,e){b=n,C=!!e,A=(e==null?void 0:e.id)??null,te.value=(e==null?void 0:e.label)??"",se.checked=(e==null?void 0:e.required)||!1,n===d.TEXT?G.classList.add("hidden"):(G.classList.remove("hidden"),H.innerHTML="",e&&e.options?e.options.forEach(t=>{oe(t.id,t.value)}):(j(),j())),he.textContent=C?"Edit Field":"Add New Field",R.classList.remove("hidden")}function U(){R.classList.add("hidden"),b=null,C=!1,A=null}function j(){const n=Date.now().toString(36)+Math.random().toString(36).substring(2);oe(n,"")}function oe(n,e){const t=document.createElement("div");t.className="option-item",t.innerHTML=`
        <input type="text" class="option-value" value="${e}" placeholder="Option text" data-id="${n}">
        <button type="button" class="remove-option">âœ•</button>
    `,t.querySelector(".remove-option").addEventListener("click",()=>{t.remove()}),H.appendChild(t)}function Te(){if(!a||!b){alert("Please select a field type.");return}const n=te.value.trim();if(!n){F.showNotification("Please enter a field label.","error");return}console.log(a);const e=se.checked;let t=[];if(b===d.RADIO||b===d.CHECKBOX||b===d.DROPDOWN){const s=H.querySelectorAll(".option-value");if(s.length<2){alert("Please add at least two options.");return}if(t=Array.from(s).map(r=>({id:r.getAttribute("data-id")??"",value:r.value.trim()})),t.some(r=>!r.value)){alert("Please fill in all option values.");return}}C&&A?a=v.updateField(a.id,A,{label:n,required:e,...t.length?{options:t}:{}}):a=v.addField(a.id,b,n,e,t),F.showNotification("Field saved successfully.","success"),U(),X()}function De(){a&&(we.textContent=a.title||"Untitled Form",Ie.textContent=a.description||"",Be.innerHTML=a.fields.sort((n,e)=>n.order-e.order).map(n=>{let e="";const t=`preview_${n.id}`;switch(n.type){case d.TEXT:e=`
                        <input type="text" id="${t}" name="${n.id}" class="preview-input">
                    `;break;case d.RADIO:e=(n.options||[]).map(s=>`
                        <div class="option-item">
                            <input type="radio" id="${t}_${s.id}" name="${n.id}" value="${s.id}">
                            <label for="${t}_${s.id}">${s.value}</label>
                        </div>
                    `).join("");break;case d.CHECKBOX:e=(n.options||[]).map(s=>`
                        <div class="option-item">
                            <input type="checkbox" id="${t}_${s.id}" name="${n.id}" value="${s.id}">
                            <label for="${t}_${s.id}">${s.value}</label>
                        </div>
                    `).join("");break;case d.DROPDOWN:e=`
                        <select id="${t}" name="${n.id}" class="preview-select">
                            <option value="">-- Select an option --</option>
                            ${(n.options||[]).map(s=>`
                                <option value="${s.id}">${s.value}</option>
                            `).join("")}
                        </select>
                    `;break}return`
                <div class="preview-field">
                    <div class="preview-label">
                        ${n.label} ${n.required?'<span class="field-required">*</span>':""}
                    </div>
                    <div class="preview-field-content">
                        ${e}
                    </div>
                </div>
            `}).join(""))}function Ae(n){if(n.preventDefault(),!a)return;const e=[];a.fields.forEach(r=>{let o="";switch(r.type){case d.TEXT:{const i=document.getElementById(`preview_${r.id}`);o=(i==null?void 0:i.value)||"";break}case d.RADIO:{const i=document.querySelector(`input[name="${r.id}"]:checked`);o=(i==null?void 0:i.value)||"";break}case d.DROPDOWN:{const i=document.getElementById(`preview_${r.id}`);o=(i==null?void 0:i.value)||"";break}case d.CHECKBOX:{const i=document.querySelectorAll(`input[name="${r.id}"]:checked`);o=Array.from(i).map(l=>l.value);break}}e.push({fieldId:r.id,value:o})});const t=me.validateFormSubmission(a,e);if(t.length>0){alert(`Please fix the following errors:
${t.join(`
`)}`);return}v.submitFormResponses(a.id,e)?(F.showNotification("Form submitted successfully!","success"),g(E),S()):F.showNotification("An error occurred while submitting the form.","error")}function Ce(n){ne(n.type,n)}function Re(n){var f;const e=v.getForm(n),t=v.getFormSubmissions(n);if(!e)return;const s=document.getElementById("exportResponsesBtn"),r=s.cloneNode(!0);(f=s.parentNode)==null||f.replaceChild(r,s),r.addEventListener("click",()=>{try{const h=qe(e,t),u=new Blob([h],{type:"application/json"}),m=window.URL.createObjectURL(u),p=document.createElement("a");p.href=m,p.download=`${e.title||"form"}_response.json`,document.body.appendChild(p),p.click(),window.URL.revokeObjectURL(m),document.body.removeChild(p)}catch(h){console.log("Export error ",h),F.showNotification("Error exporting responses","error")}});const o=document.getElementById("responsesFormTitle"),i=document.getElementById("responsesSummary"),l=document.getElementById("responsesList");if(o.textContent=`Responses for: ${e.title||"Untitled Form"}`,i.innerHTML=`
        <div class="summary-card">
            <h3>Total Submissions</h3>
            <p class="summary-number">${t.length}</p>
        </div>
    `,t.length===0)l.innerHTML='<div class="empty-state">No responses yet.</div>';else{const h=e.fields.reduce((u,m)=>(u[m.id]=m,u),{});l.innerHTML=t.map((u,m)=>{const p=new Date(u.submittedAt),$=p.toLocaleDateString()+" "+p.toLocaleTimeString(),q=u.responses.map(O=>{var V;const w=h[O.fieldId];if(!w)return"";let k="";switch(w.type){case d.TEXT:k=O.value;break;case d.RADIO:case d.DROPDOWN:{const K=O.value,T=(V=w.options)==null?void 0:V.find(D=>D.id===K);k=T?T.value:"Unknown option";break}case d.CHECKBOX:{k=O.value.map(T=>{var W;const D=(W=w.options)==null?void 0:W.find(ie=>ie.id===T);return D?D.value:"Unknown option"}).join(", ");break}}return`
                    <div class="response-item">
                        <div class="response-question">${w.label}</div>
                        <div class="response-answer">${k||"No response"}</div>
                    </div>
                `}).join("");return`
                <div class="response-card">
                    <div class="response-header">
                        <h3>Response #${m+1}</h3>
                        <div class="response-date">${$}</div>
                    </div>
                    <div class="response-body">
                        ${q}
                    </div>
                </div>
            `}).join("")}document.getElementById("backToFormsBtn").addEventListener("click",()=>{g(E)}),g(Z)}function qe(n,e){const t=n.fields.reduce((o,i)=>(o[i.id]=i,o),{}),s={formTitle:n.title,formDescription:n.description,submissions:e.map(o=>{const i=o.responses.reduce((l,c)=>{var h;const f=t[c.fieldId];if(f){let u=c.value;if((f.type===d.RADIO||f.type===d.DROPDOWN)&&typeof u=="string"){const m=(h=f.options)==null?void 0:h.find(p=>p.id===u);u=m?m.value:u}f.type===d.CHECKBOX&&Array.isArray(u)&&(u=u.map(m=>{var $;const p=($=f.options)==null?void 0:$.find(q=>q.id===m);return p?p.value:m})),l[f.label]=u}return l},{});return{submissionDate:new Date(o.submittedAt).toISOString(),responses:i}})};return JSON.stringify(s,null,2)}
